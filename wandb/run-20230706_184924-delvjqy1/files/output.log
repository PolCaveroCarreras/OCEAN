wandb: WARNING Calling wandb.run.save without any arguments is deprecated.Changes to attributes are automatically persisted.
  0%|          | 0/478 [00:00<?, ?batch/s]
loss:0.6932003498077393
loss:0.6889275312423706
loss:0.6832826137542725
loss:0.6532675623893738
loss:0.6285033226013184
loss:0.6112788915634155
loss:0.614088773727417

  3%|▎         | 12/478 [00:05<01:26,  5.42batch/s]
loss:0.6254536509513855
loss:0.6052186489105225
loss:0.6182591319084167
loss:0.6017137169837952
loss:0.605522632598877
loss:0.5939038395881653
loss:0.6013116836547852
loss:0.6194406747817993
loss:0.5740166902542114
loss:0.5911126136779785
loss:0.6133381128311157

  5%|▌         | 25/478 [00:07<01:11,  6.31batch/s]
loss:0.5921894311904907
loss:0.5845452547073364
loss:0.6269035935401917
loss:0.5949786305427551
loss:0.5921881198883057
loss:0.6241483688354492
loss:0.5888770818710327
loss:0.5856636762619019
loss:0.576702356338501
loss:0.5578721761703491
loss:0.5409914255142212
loss:0.5638185739517212

  8%|▊         | 37/478 [00:09<01:12,  6.05batch/s]
loss:0.5663525462150574
loss:0.5591635704040527
loss:0.585178792476654
loss:0.6316589117050171
loss:0.5631870031356812
loss:0.5725218057632446
loss:0.5624932050704956
loss:0.573510468006134
loss:0.5440559387207031
loss:0.5408719182014465
loss:0.5825207233428955

 10%|█         | 50/478 [00:11<01:06,  6.39batch/s]
loss:0.5384407639503479
loss:0.5152340531349182
loss:0.5749304294586182
loss:0.6028478145599365
loss:0.5872433185577393
loss:0.5409955382347107
loss:0.5545287132263184
loss:0.5586537718772888
loss:0.5975996255874634
loss:0.563693642616272
loss:0.5665061473846436
loss:0.5252606272697449

 13%|█▎        | 63/478 [00:13<01:07,  6.17batch/s]
loss:0.6058697700500488
loss:0.5532650947570801
loss:0.5578216314315796
loss:0.581367015838623
loss:0.572068452835083
loss:0.5477274656295776
loss:0.5756498575210571
loss:0.5863649845123291
loss:0.5096358060836792
loss:0.5597374439239502
loss:0.5693235397338867
loss:0.5285386443138123

 16%|█▌        | 75/478 [00:15<01:04,  6.29batch/s]
loss:0.5508836507797241
loss:0.6083171367645264
loss:0.509095311164856
loss:0.5058717727661133
loss:0.6287893056869507
loss:0.5275605916976929
loss:0.6008485555648804
loss:0.5473642945289612
loss:0.5299981832504272
loss:0.5569040775299072
loss:0.5645859241485596

 18%|█▊        | 88/478 [00:17<01:02,  6.19batch/s]
loss:0.5648584365844727
loss:0.5547565221786499
loss:0.5573970079421997
loss:0.5444779992103577
loss:0.5440576672554016
loss:0.5296380519866943
loss:0.5330638885498047
loss:0.5588511228561401
loss:0.5662398338317871
loss:0.5553128719329834
loss:0.5552358627319336

 21%|██        | 100/478 [00:19<01:01,  6.15batch/s]
loss:0.5540046691894531
loss:0.5326844453811646
loss:0.5695533752441406
loss:0.5738610029220581
loss:0.5343018174171448
loss:0.5695126056671143
loss:0.5456898212432861
loss:0.5145450830459595
loss:0.5421005487442017
loss:0.5819076299667358
loss:0.5034555196762085
loss:0.508969783782959

 24%|██▎       | 113/478 [00:21<00:58,  6.28batch/s]
loss:0.5826712846755981
loss:0.5485529899597168
loss:0.532921314239502
loss:0.5569480657577515
loss:0.5767126083374023
loss:0.5180438756942749
loss:0.5535305142402649
loss:0.5484352707862854
loss:0.5443980693817139
loss:0.52149498462677
loss:0.4926665425300598

 26%|██▌       | 125/478 [00:23<00:56,  6.22batch/s]
loss:0.5374078750610352
loss:0.5468124747276306
loss:0.5328071117401123
loss:0.5033513307571411
loss:0.5461175441741943
loss:0.514085590839386
loss:0.5114800930023193
loss:0.5064276456832886
loss:0.5077503323554993
loss:0.5163200497627258
loss:0.5263182520866394
loss:0.500265896320343

 29%|██▊       | 137/478 [00:25<00:55,  6.11batch/s]
loss:0.518013060092926
loss:0.5615420341491699
loss:0.541512668132782
loss:0.5211115479469299
loss:0.5101966857910156
loss:0.505779504776001
loss:0.5212615132331848
loss:0.49661827087402344
loss:0.4978905916213989
loss:0.5202486515045166
loss:0.531811535358429

 31%|███▏      | 150/478 [00:27<00:52,  6.31batch/s]
loss:0.5015767812728882
loss:0.5057677030563354
loss:0.5255332589149475
loss:0.533166766166687
loss:0.5137810111045837
loss:0.4734167456626892
loss:0.513741135597229
loss:0.529518187046051
loss:0.47419509291648865
loss:0.5321425199508667
loss:0.4826214611530304

 34%|███▍      | 162/478 [00:29<00:48,  6.57batch/s]
loss:0.5124050378799438
loss:0.48484835028648376
loss:0.5201994776725769
loss:0.524142861366272
loss:0.4846149981021881
loss:0.5049116015434265
loss:0.5365340709686279
loss:0.5135097503662109
loss:0.5349974632263184
loss:0.49762192368507385
loss:0.5085662603378296
loss:0.4698971211910248
loss:0.4946022927761078

 37%|███▋      | 175/478 [00:31<00:47,  6.40batch/s]
loss:0.5271893739700317
loss:0.516082763671875
loss:0.5079760551452637
loss:0.5055364370346069
loss:0.5262554287910461
loss:0.4541436433792114
loss:0.5670000314712524
loss:0.49632495641708374
loss:0.49689921736717224
loss:0.5340111255645752
loss:0.5376348495483398

 39%|███▉      | 188/478 [00:33<00:45,  6.32batch/s]
loss:0.4657483696937561
loss:0.5054107904434204
loss:0.5137233734130859
loss:0.5529292225837708
loss:0.503876805305481
loss:0.5094993114471436
loss:0.5061139464378357
loss:0.5204399228096008
loss:0.5374783277511597
loss:0.5585236549377441
loss:0.54052734375
loss:0.46469613909721375

 42%|████▏     | 201/478 [00:35<00:43,  6.32batch/s]
loss:0.5051740407943726
loss:0.49785634875297546
loss:0.4640006721019745
loss:0.4983305335044861
loss:0.4556584060192108
loss:0.46757054328918457
loss:0.50542813539505
loss:0.4504268169403076
loss:0.504804790019989
loss:0.5077858567237854
loss:0.4818137586116791
loss:0.5018879175186157

 45%|████▍     | 214/478 [00:37<00:40,  6.47batch/s]
loss:0.46022018790245056
loss:0.4904562830924988
loss:0.4694717228412628
loss:0.4841078221797943
loss:0.53446364402771
loss:0.5202165246009827
loss:0.5047010779380798
loss:0.4779014587402344
loss:0.4876070022583008
loss:0.49087780714035034
loss:0.48989349603652954
loss:0.5172505974769592

 47%|████▋     | 226/478 [00:39<00:39,  6.34batch/s]
loss:0.5276718735694885
loss:0.4834965467453003
loss:0.5002503395080566
loss:0.5353313684463501
loss:0.4816228151321411
loss:0.5040093660354614
loss:0.545117974281311
loss:0.5623420476913452
loss:0.5109899044036865
loss:0.4996999204158783
loss:0.4826287627220154

 50%|█████     | 239/478 [00:41<00:36,  6.47batch/s]
loss:0.5028579235076904
loss:0.4646303653717041
loss:0.49670010805130005
loss:0.46482959389686584
loss:0.49646979570388794
loss:0.48791491985321045
loss:0.4987579584121704
loss:0.5026974678039551
loss:0.4751756191253662
loss:0.4889051914215088
loss:0.4648721218109131
loss:0.49255913496017456

 53%|█████▎    | 252/478 [00:43<00:35,  6.29batch/s]
loss:0.4707341194152832
loss:0.5146245956420898
loss:0.48922890424728394
loss:0.47718381881713867
loss:0.4719940423965454
loss:0.49658262729644775
loss:0.4649379253387451
loss:0.461357980966568
loss:0.4919183552265167
loss:0.45736396312713623
loss:0.47073236107826233
loss:0.482972651720047

 55%|█████▌    | 265/478 [00:45<00:33,  6.41batch/s]
loss:0.46257513761520386
loss:0.4837254583835602
loss:0.4779779016971588
loss:0.5028179287910461
loss:0.48590216040611267
loss:0.45317596197128296
loss:0.5373774766921997
loss:0.4808676540851593
loss:0.5099088549613953
loss:0.49205902218818665
loss:0.5257806777954102

 58%|█████▊    | 277/478 [00:47<00:31,  6.30batch/s]
loss:0.5008442997932434
loss:0.501340925693512
loss:0.5200170874595642
loss:0.5311516523361206
loss:0.47332900762557983
loss:0.47604888677597046
loss:0.4789685010910034
loss:0.4687156677246094
loss:0.4780876338481903
loss:0.4515484869480133
loss:0.47523435950279236
loss:0.4537404775619507

 61%|██████    | 290/478 [00:49<00:29,  6.27batch/s]
loss:0.4538349509239197
loss:0.4876987934112549
loss:0.5206518173217773
loss:0.45735013484954834
loss:0.5023587942123413
loss:0.437667578458786
loss:0.47906941175460815
loss:0.4628617465496063
loss:0.498536080121994
loss:0.4812527894973755
loss:0.49997952580451965
loss:0.4853759706020355

 63%|██████▎   | 303/478 [00:52<00:27,  6.32batch/s]
loss:0.45707714557647705
loss:0.48043715953826904
loss:0.49078869819641113
loss:0.5036038160324097
loss:0.4904680848121643
loss:0.4503190219402313
loss:0.5039130449295044
loss:0.4585924744606018
loss:0.4632275104522705
loss:0.4674556255340576
loss:0.4818180501461029

 66%|██████▌   | 315/478 [00:53<00:26,  6.13batch/s]
loss:0.4757453203201294
loss:0.4622843265533447
loss:0.4627608358860016
loss:0.4865332245826721
loss:0.4644795060157776
loss:0.4566246569156647
loss:0.47855719923973083
loss:0.4477819800376892
loss:0.4832252264022827
loss:0.4545893967151642
loss:0.4615307152271271
loss:0.4689266085624695

 69%|██████▊   | 328/478 [00:56<00:23,  6.41batch/s]
loss:0.48348087072372437
loss:0.4841912090778351
loss:0.46188491582870483
loss:0.47634899616241455
loss:0.4592624604701996
loss:0.5148394703865051
loss:0.4283584952354431
loss:0.45077061653137207
loss:0.4977485239505768
loss:0.43747276067733765
loss:0.4612044095993042

 71%|███████   | 340/478 [00:57<00:22,  6.18batch/s]
loss:0.49202442169189453
loss:0.46568888425827026
loss:0.5100662708282471
loss:0.4454593062400818
loss:0.4704477787017822
loss:0.49290183186531067
loss:0.47014251351356506
loss:0.49229544401168823
loss:0.4795052111148834
loss:0.4607248604297638
loss:0.47972390055656433
loss:0.4632050395011902

 74%|███████▎  | 352/478 [00:59<00:20,  6.29batch/s]
loss:0.47099101543426514
loss:0.4449079632759094
loss:0.4730977416038513
loss:0.46883296966552734
loss:0.5244382619857788
loss:0.5070993900299072
loss:0.47411632537841797
loss:0.4611719250679016
loss:0.47680923342704773
loss:0.4502284526824951
loss:0.4632822573184967

 76%|███████▋  | 365/478 [01:01<00:17,  6.30batch/s]
loss:0.48469018936157227
loss:0.49445202946662903
loss:0.48811274766921997
loss:0.4817933440208435
loss:0.49816954135894775
loss:0.46047452092170715
loss:0.46420934796333313
loss:0.525408923625946
loss:0.4890860617160797
loss:0.4685631990432739
loss:0.4860345125198364
loss:0.44856032729148865

 79%|███████▉  | 378/478 [01:03<00:15,  6.30batch/s]
loss:0.47633427381515503
loss:0.4680199921131134
loss:0.4953308701515198
loss:0.49797970056533813
loss:0.45678457617759705
loss:0.49729597568511963
loss:0.48871469497680664
loss:0.46701639890670776
loss:0.45414939522743225
loss:0.47978097200393677
loss:0.4812345504760742
loss:0.4767707586288452

 82%|████████▏ | 390/478 [01:05<00:14,  6.14batch/s]
loss:0.4795910120010376
loss:0.5323675870895386
loss:0.4809436798095703
loss:0.45769065618515015
loss:0.47003746032714844
loss:0.4540063738822937
loss:0.46845853328704834
loss:0.4765326976776123
loss:0.4809073209762573
loss:0.4880858063697815
loss:0.5062882304191589

 84%|████████▍ | 403/478 [01:07<00:11,  6.35batch/s]
loss:0.5132046937942505
loss:0.47711002826690674
loss:0.4665086269378662
loss:0.4762990474700928
loss:0.49029260873794556
loss:0.474463552236557
loss:0.47650325298309326
loss:0.47360867261886597
loss:0.4959765672683716
loss:0.5116932988166809
loss:0.5078136324882507
loss:0.4848247468471527

 87%|████████▋ | 416/478 [01:10<00:10,  6.17batch/s]
loss:0.4703367352485657
loss:0.4460738003253937
loss:0.4856322407722473
loss:0.5068522095680237
loss:0.4819393754005432
loss:0.4586295485496521
loss:0.518610954284668
loss:0.44500595331192017
loss:0.4796837866306305
loss:0.457575261592865
loss:0.5009153485298157

 90%|████████▉ | 428/478 [01:11<00:07,  6.31batch/s]
loss:0.4797280430793762
loss:0.4832667112350464
loss:0.4904477894306183
loss:0.458037793636322
loss:0.4751019775867462
loss:0.4778825342655182
loss:0.46912771463394165
loss:0.46521300077438354
loss:0.4826342463493347
loss:0.49578583240509033
loss:0.49123722314834595
loss:0.4742155075073242

 92%|█████████▏| 441/478 [01:14<00:05,  6.23batch/s]
loss:0.49977588653564453
loss:0.4494501054286957
loss:0.4663805067539215
loss:0.4898454546928406
loss:0.4618217349052429
loss:0.47795194387435913
loss:0.46487361192703247
loss:0.4611090123653412
loss:0.4651681184768677
loss:0.48406147956848145
loss:0.4340413808822632

 95%|█████████▍| 453/478 [01:15<00:03,  6.30batch/s]
loss:0.5048361420631409
loss:0.47709962725639343
loss:0.5002292394638062
loss:0.5173956155776978
loss:0.4817982316017151
loss:0.4908113181591034
loss:0.4814337491989136
loss:0.48447754979133606
loss:0.4606758654117584
loss:0.4749348759651184
loss:0.528472900390625
loss:0.4496837854385376

 97%|█████████▋| 466/478 [01:18<00:01,  6.27batch/s]
loss:0.4906965494155884
loss:0.48460158705711365
loss:0.4608733057975769
loss:0.47860974073410034
loss:0.4605034291744232
loss:0.4685099720954895
loss:0.49394580721855164
loss:0.47849276661872864
loss:0.5104959607124329
loss:0.4835187792778015
loss:0.47677913308143616

100%|██████████| 478/478 [01:19<00:00,  5.98batch/s]
loss:0.49700048565864563
loss:0.477873295545578
loss:0.45013269782066345
loss:0.46195188164711
loss:0.5244743227958679
Train Epoch 0 loss=0.51 acc=0.83
Eval Epoch 0 loss=0.50 acc=0.84
Traceback (most recent call last):
  File "src/main.py", line 252, in <module>
    my_model = train_model(config)
  File "src/main.py", line 168, in train_model
    outputs = my_model(images)
  File "/home/usuaris/veu/pol.cavero/miniconda3/envs/ocean/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/usuaris/veu/pol.cavero/OCEAN/src/DMHA.py", line 148, in forward
    inner_products, inner_products_m_s = self.am_softmax_layer(embedding_3, label)
  File "/home/usuaris/veu/pol.cavero/miniconda3/envs/ocean/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/usuaris/veu/pol.cavero/OCEAN/src/loss.py", line 28, in forward
    assert last_features.size()[0] == label.size()[0] # checks the batch dimension
AttributeError: 'NoneType' object has no attribute 'size'
Test loss=0.50 acc=0.85