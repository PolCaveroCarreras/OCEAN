tensor([[[[0.1153, 0.1126, 0.1704,  ..., 0.1910, 0.1631, 0.1602],
          [0.1139, 0.1205, 0.1189,  ..., 0.1402, 0.1301, 0.1153],
          [0.0590, 0.1524, 0.0905,  ..., 0.1239, 0.1468, 0.1271],
          ...,
          [0.1684, 0.1583, 0.1435,  ..., 0.1228, 0.1351, 0.1227],
          [0.1147, 0.1519, 0.1286,  ..., 0.1232, 0.1634, 0.1330],
          [0.1172, 0.0804, 0.2150,  ..., 0.1530, 0.1875, 0.1861]]],
        [[[0.1386, 0.0971, 0.1556,  ..., 0.2333, 0.1530, 0.1387],
          [0.0944, 0.0764, 0.1712,  ..., 0.1434, 0.1043, 0.1313],
          [0.1042, 0.1145, 0.0982,  ..., 0.1104, 0.0935, 0.1288],
          ...,
          [0.1037, 0.1638, 0.1337,  ..., 0.1101, 0.1082, 0.1360],
          [0.1177, 0.0627, 0.1634,  ..., 0.1333, 0.0917, 0.1493],
          [0.1426, 0.1489, 0.1324,  ..., 0.1451, 0.1650, 0.1241]]],
        [[[0.1475, 0.0808, 0.1297,  ..., 0.1812, 0.1444, 0.1249],
          [0.1023, 0.1506, 0.1161,  ..., 0.1380, 0.1042, 0.1348],
          [0.1364, 0.0980, 0.1162,  ..., 0.1179, 0.1637, 0.1031],
          ...,
          [0.1229, 0.1363, 0.0924,  ..., 0.1324, 0.1356, 0.1342],
          [0.1274, 0.0485, 0.1340,  ..., 0.1190, 0.1520, 0.1153],
          [0.1671, 0.1016, 0.1686,  ..., 0.1469, 0.1267, 0.1406]]],
        ...,
        [[[0.1471, 0.1660, 0.1059,  ..., 0.1714, 0.1211, 0.1393],
          [0.1215, 0.1062, 0.1255,  ..., 0.1282, 0.1109, 0.1060],
          [0.1237, 0.1391, 0.1186,  ..., 0.1407, 0.1349, 0.1813],
          ...,
          [0.1163, 0.0824, 0.1349,  ..., 0.1503, 0.1224, 0.1303],
          [0.1100, 0.1219, 0.1501,  ..., 0.0923, 0.1443, 0.1175],
          [0.1331, 0.1118, 0.0907,  ..., 0.1490, 0.1016, 0.1666]]],
        [[[0.1291, 0.1340, 0.1331,  ..., 0.1684, 0.0923, 0.2027],
          [0.1440, 0.0873, 0.1470,  ..., 0.1054, 0.1355, 0.1153],
          [0.1286, 0.1387, 0.1647,  ..., 0.1165, 0.1400, 0.1366],
          ...,
          [0.0974, 0.1273, 0.1619,  ..., 0.1276, 0.1117, 0.1395],
          [0.1101, 0.1129, 0.1010,  ..., 0.1387, 0.1329, 0.1106],
          [0.1308, 0.0968, 0.1557,  ..., 0.1458, 0.1595, 0.1477]]],
        [[[0.1153, 0.1133, 0.2030,  ..., 0.1724, 0.1589, 0.1285],
          [0.0308, 0.1112, 0.1210,  ..., 0.1429, 0.1481, 0.1335],
          [0.1001, 0.1438, 0.1174,  ..., 0.1339, 0.1447, 0.1364],
          ...,
          [0.0901, 0.1097, 0.1304,  ..., 0.1433, 0.1246, 0.1209],
          [0.1127, 0.1211, 0.1226,  ..., 0.1700, 0.1255, 0.1464],
          [0.0751, 0.2307, 0.1516,  ..., 0.1645, 0.1139, 0.1639]]]],
       grad_fn=<MaxPool2DWithIndicesBackward0>)
wandb: WARNING Calling wandb.run.save without any arguments is deprecated.Changes to attributes are automatically persisted.
  0%|          | 0/478 [00:00<?, ?batch/s]
Traceback (most recent call last):
  File "src/main.py", line 233, in <module>
    my_model = train_model(config)
  File "src/main.py", line 139, in train_model
    train_loss, train_acc = train_single_epoch(my_model, train_loader, optimizer)
  File "src/main.py", line 51, in train_single_epoch
    y_ = model(x, y)[0] #                   POL: AFEGIT [0]
  File "/home/usuaris/veu/pol.cavero/miniconda3/envs/ocean/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/usuaris/veu/pol.cavero/OCEAN/src/DMHA.py", line 131, in forward
    embedding_0, alignment = self.poolingLayer(encoder_output)
  File "/home/usuaris/veu/pol.cavero/miniconda3/envs/ocean/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/usuaris/veu/pol.cavero/OCEAN/src/poolings_original.py", line 152, in forward
    utteranceRepresentation, alignment = self.utteranceAttention(x)
  File "/home/usuaris/veu/pol.cavero/miniconda3/envs/ocean/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/usuaris/veu/pol.cavero/OCEAN/src/poolings_original.py", line 130, in forward
    headsContextVectors = self.getHeadsContextVectors(ht)
  File "/home/usuaris/veu/pol.cavero/OCEAN/src/poolings_original.py", line 124, in getHeadsContextVectors
    key = ht.view(batch_size*ht.size(1), self.heads_number, self.head_size)
RuntimeError: shape '[1152, 5, 4]' is invalid for input of size 11520